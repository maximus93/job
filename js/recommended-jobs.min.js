var TotalJobsGroup=TotalJobsGroup||{};TotalJobsGroup.Personalisation=TotalJobsGroup.Personalisation||{},TotalJobsGroup.Personalisation.RecommendedJobs=TotalJobsGroup.Personalisation.RecommendedJobs||{},TotalJobsGroup.Personalisation.RecommendedJobs.DataService=function(o){"use strict";function e(){return o.ajax({type:"GET",data:{origin:analytics.RecommendedJobsOrigin},url:t.getRecommendationsServiceUrl,contentType:"text/html; charset=utf-8",timeout:t.timeout})}function n(e){return o.ajax({type:"POST",url:t.discardJobServiceUrl,data:{jobId:e},timeout:t.timeout})}var t={getRecommendationsServiceUrl:"/Personalisation/RecommendedJobs",discardJobServiceUrl:"/Personalisation/RecommendedJobs/Dismiss",timeout:"10000"};return{getRecommendations:e,discardJob:n}}(jQuery),TotalJobsGroup.Personalisation.RecommendedJobs.Helpers=function(){"use strict";function o(o,e){var n=o.closest(".rj-results-container");void 0!==e&&e.length>0?n.hasClass("hidden")&&n.removeClass("hidden"):n.hasClass("hidden")||n.addClass("hidden")}function e(o){"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log(o)}function n(){return window.TransitionEvent}return{showRecommendedJobsSectionIfWeHaveData:o,log:e,isCssAnimationSupported:n}}(),TotalJobsGroup.Personalisation.RecommendedJobs=function(o,e,n){"use strict";function t(){o(".rj-jobs-list").children("."+j).first().addClass(g).removeClass(j)}function a(o){return{jobId:o.attr("data-job-id"),dataRank:o.attr("data-rank")}}function s(){return h}function i(e){var a=o("#"+e.jobId),s=a.index();n.isCssAnimationSupported()?(o(".rj-jobs-list>div:eq("+s+")").addClass("animated bounceOutLeft"),o(".rj-jobs-list>div:gt("+s+")").addClass("animated moveLeft"),setTimeout(function(){o(".rj-jobs-list>div:gt("+s+")").removeClass("animated moveLeft"),t(),a.remove()},750)):(t(),a.remove())}function r(n){n.preventDefault(),R++,h--;var t=a(o(this));c(),i(t),e.discardJob(t.jobId,t.dataRank).fail()}function d(e){R++,h--;var n=o(e)[0],t={jobId:n.id,dataRank:0};c(),i(t)}function l(){o(p).one("click",".left-box button",r)}function c(){1===h?o(".rj-list-title").html('<span class="hidden-sm hidden-md hidden-lg">1</span> Recommended job'):o(".rj-list-title").html('<span class="hidden-sm hidden-md hidden-lg">'+h+"</span> Recommended jobs")}function u(){window.SavedJobsManager=window.SavedJobsManager||SavedJobs.Manager(o);var e=SavedJobs.Events(o,window.SavedJobsManager);o('div[id^="rj-results"]').on("update",".btn-savejob",function(e,n){void 0!==n&&n.isInitialUpdate===!0||o(this).hasClass("saved")&&(d(this),v())}),e.bindEvents(),e.triggerEvents({isInitialUpdate:!0});var n=window.Toast;n.bindEvents()}function m(t){e.getRecommendations().success(function(e,a,s){if(200===s.status)try{var i=o(e);i.find(p).slice(0,3).addClass(g).removeClass(j),t.html(i),h=o(J).length-1,c(),l(),u()}finally{analLib.fireRecomendedJobsEvents("event74","Recommended Jobs Served",b())}else 204===s.status?n.log("No jobs found"):n.log("An error occurred :o| ["+a+"]")}).fail(function(o){n.log("An error occurred :o( ["+o.status+"]")})}function b(){var e=o(".rj-row-holder:visible"),n=e.length,t=e.find(".rj-hero:not(.watermark)").length;return n===t?"All":0===t?"None":t}function v(){var o=window.SavedJobsManager;o&&o.trackOnSitecatalyst("event901","Recommended Job Saved")}function f(){var e=o("#recommended-jobs-placeholder");e.length&&m(e,1)}var p=".rj-row-holder",J=".rj-job-container",g="rj-visible-row",j="rj-hidden-row",h=0,R=0;return o(document).ready(f),{retrieveRecommendations:m,getNumberOfRecommendedJobs:s}}(jQuery,TotalJobsGroup.Personalisation.RecommendedJobs.DataService,TotalJobsGroup.Personalisation.RecommendedJobs.Helpers);var TotalJobsGroup=TotalJobsGroup||{};TotalJobsGroup.Personalisation=TotalJobsGroup.Personalisation||{},TotalJobsGroup.Personalisation.RecommendedJobs=TotalJobsGroup.Personalisation.RecommendedJobs||{},TotalJobsGroup.Personalisation.RecommendedJobs.Logging=function(o){var e=function(e,n,t){200===t.status&&o.ajax({url:"/personalisation/recommenderdatalogger/logdata",data:JSON.stringify({search:e}),contentType:"application/json; charset=utf-8",dataType:"json",type:"post",cache:!1})};this.log=function(n){var t="function"!=typeof n?n:n();if(t){var a=JSON.stringify(t);o.ajax({url:"/personalisation/recommenderdatastamper/stamp",data:{data:a},dataType:"json",type:"post"}).done(e)}},this.logToPersonalisation=e};
//# sourceMappingURL=recommended-jobs.min.js.map
