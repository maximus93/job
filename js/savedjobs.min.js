var SavedJobs=SavedJobs||{};SavedJobs.Properties={CookieName:"JBM_COOKIE",JobsiteCookieName:"saved_jobs",DeclineCookieName:"PJBOPTIN",CookieDelimiter:",",JobsiteCookieDelimiter:":",MaxItems:99,EmptyText:"0 Saved jobs",FillText:"{0} Saved jobs",MaxItemsReachedText:"You can save a maximum of 99 jobs. Do you want to view your saved jobs now?",SavedJobsUrl:"/SavedJobs/",FillTextSingular:"1 Saved job"};var SavedJobs=SavedJobs||{};SavedJobs.Manager=function(e,t){function o(){var t=SavedJobs.Properties.CookieName,o=SavedJobs.Properties.CookieDelimiter;w&&(t=SavedJobs.Properties.JobsiteCookieName,o=SavedJobs.Properties.JobsiteCookieDelimiter);var i=C.join(o);n(t,i),e(".jb-status").trigger("update")}function n(t,o){e.cookie(t,o,{path:"/",expires:365})}function i(){var t=SavedJobs.Properties.CookieName,o=SavedJobs.Properties.CookieDelimiter;w&&(t=SavedJobs.Properties.JobsiteCookieName,o=SavedJobs.Properties.JobsiteCookieDelimiter);var n=e.cookie(t);if(null!==n&&"undefined"!=typeof n&&(n=n.toString()),n){var i=n;if(n.indexOf("|")>-1&&(i=n.split("|")[0]),null!==i&&"undefined"!=typeof i)return void(i.indexOf(o)>-1?C=i.split(o):(C=[],C[0]=i))}}function a(e){var t;for(t=0;t<C.length;t++)if(parseInt(C[t],10)===e)return t;return-1}function r(e){return a(e)>-1}function u(){var t=SavedJobs.Properties.DeclineCookieName;return"decline"!==e.cookie(t)&&(e.cookie("cookietester","cookietesterdata"),"cookietesterdata"===e.cookie("cookietester")||"decline"!==e.cookie(t))&&(e.cookie("cookietester",null),!0)}function d(t,n){var r=SavedJobs.Properties.MaxItems;i();var u=a(t);if(u===-1){var d=C.length;if(d>=r)return s.tl(this,"o","Max Saved Jobs Reached"),confirm(SavedJobs.Properties.MaxItemsReachedText)?void(window.location=SavedJobs.Properties.SavedJobsUrl):void b(!1);h(function(i){0===i?(C.push(t),o(),n(!0)):w?e.getJSON("/cgi-bin/job_basket.cgi",{json:1,screen:"add",vac_ref:t},function(e){v(e,n)}).fail(function(){n(!1)}):e.post("/savedjobs/storage/AddSavedJob",{jobId:t},function(e){v(e,n)},"json").fail(function(){n(!1)})})}}function c(t,n){i();var r=a(t);r>-1&&h(function(i){0===i?(C.splice(r,1),o(),n(!0)):w?e.getJSON("/cgi-bin/job_basket.cgi",{json:1,screen:"delete",vac_ref:t},function(e){v(e,n)}).fail(function(){n(!1)}):e.post("/savedjobs/storage/RemoveSavedJob",{jobId:t},function(e){v(e,n)},"json").fail(function(){n(!1)})})}function v(e,t){var n=!1;w&&(e=l(e)),null!==e&&(C=e,o(),n=!0),t(n)}function l(e){var t=[];return e&&e.vacancies&&e.vacancies.forEach(function(e){e&&e.id&&t.push(e.id)}),t}function f(){return y}function b(e){y=e}function p(){return i(),C.length}function m(){return e.cookie(x)}function g(){m()&&e.cookie(x,null,{path:"/"})}function h(t){if("undefined"!=typeof TotalJobsGroup&&"undefined"!=typeof TotalJobsGroup.Header&&"function"==typeof TotalJobsGroup.Header.AccountDetails&&"undefined"!=typeof TotalJobsGroup.Config&&"undefined"!=typeof TotalJobsGroup.Config.Global){var o=new TotalJobsGroup.Header.AccountDetails(e,window.location,TotalJobsGroup.Config.Global,TotalJobsGroup.IsJobsiteBrand);o.getAccountDetails(function(e){t(e.LoggedInState)})}}function j(t){h(function(o){if(0===o)return g(),void t(!0);var n="/savedjobs/storage/syncsavedjobs",i={};w&&(n="/cgi-bin/job_basket.cgi",i.json=1),e.getJSON(n,i).done(function(e){v(e,t)})})}function S(e,t){var o=s_gi(k());o.linkTrackVars="events",o.linkTrackEvents=e,o.events=e,o.tl(this,"o",t)}function J(e,t){var o=s_gi(k());o.linkTrackVars="eVar23,events",o.linkTrackEvents=e,o.events=e,o.tl(this,"o",t)}function k(){return analLib.getSiteId()}var C=[],x="SavedJobsDoneInitialMergeOnLogin",y=!1,w=t;return u()&&i(),{add:d,remove:c,getCount:p,isSaved:r,refreshSavedJobsFromServer:j,getIsCommunicatingWithServer:f,setIsCommunicatingWithServer:b,getLoggedInState:h,trackOnAppMeasurement:S,trackClickApplyOnAppMeasurement:J}};var SavedJobs=SavedJobs||{};window.console||(window.console={},window.console.log=function(){}),SavedJobs.Events=function(e,t,o){function n(e){var o=e.hasClass("ext-url")?"event28":"event28,event35";t.trackClickApplyOnAppMeasurement(o,"Click on Apply")}function i(e){if(b){var t=a(e);if(t)return t}return parseInt(e.attr("id"))}function a(e){return e.attr("data-external-job-id")?parseInt(e.attr("data-external-job-id")):null}function r(e){return isNaN(i(e))||t.getIsCommunicatingWithServer()||(t.setIsCommunicatingWithServer(!0),t.isSaved(i(e))?t.remove(i(e),function(o){t.setIsCommunicatingWithServer(!1),o?(e.trigger("update"),t.trackOnAppMeasurement("event59","Saved listing deleted")):console.log("Error: unable to remove saved job")}):t.add(i(e),function(o){t.setIsCommunicatingWithServer(!1),o?(e.trigger("update"),t.trackOnAppMeasurement("event16","Job Saved")):console.log("Error: unable to save job")})),!1}function s(e){e.removeClass("btn-mobile-hover-fix")}function u(e){e.addClass("btn-mobile-hover-fix")}function d(o){if(t.isSaved(i(o))?(o.addClass("saved"),"BUTTON"===o.prop("tagName")&&o.html("Saved")):(o.removeClass("saved"),"BUTTON"===o.prop("tagName")&&o.html("Save")),o.blur(),!f){f=!0;var n=o.attr("id");n.indexOf("_")!==-1&&e("[id^="+i(o)+"]").each(function(){var t=e(this).attr("id");t!==n&&e(this).trigger("update")}),f=!1}}function c(){String.format||(String.format=function(){var e,t;for(e=1;e<arguments.length;e++)t=new RegExp("\\{"+(e-1)+"\\}","gm"),arguments[0]=arguments[0].replace(t,arguments[e]);return arguments[0]});var o=e(".jb-status"),n=e("#navbar-savedjobs"),i=n.length,a=t.getCount(),r=e("#menu_SavedJobslink span").length;if(a>0){e(".icon_saved_jobs").show(),e("#jb-status-count").show();var s=a,u=SavedJobs.Properties.MaxItems;a>u&&(s=u),e("#jb-status-count span").text(s),e("#jb-header-message span").text(s),r||(n.removeClass("navbar-saved-jobs-empty-icon"),n.addClass("navbar-saved-jobs-icon"),i?o.removeClass("jb-status-empty").html(s):1==a?o.removeClass("jb-status-empty").html(String.format(SavedJobs.Properties.FillTextSingular,a)):a>1&&o.removeClass("jb-status-empty").html(String.format(SavedJobs.Properties.FillText,a)))}else r||(n.removeClass("navbar-saved-jobs-icon"),n.addClass("navbar-saved-jobs-empty-icon"),i?o.addClass("jb-status-empty").html("0"):o.addClass("jb-status-empty").html(SavedJobs.Properties.EmptyText)),e(".icon_saved_jobs").hide(),e("#jb-status-count").hide()}function v(){e(".jb-status").bind("update",c),e(".saved-jobs-icon").each(function(t,o){var n=e(o);n.removeClass("disabled"),n.removeAttr("disabled"),"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?(n.on("click",function(){return r(n)}),n.on("update",function(){d(n)}),n.on("touchstart",function(){s(n)}),n.on("touchend touchcancel",function(){u(n)})):(n.click(function(){return r(n)}),n.bind("update",function(){d(n)}),n.bind("touchstart",function(){s(n)}),n.bind("touchend touchcancel",function(){u(n)}))}),e(".apply-for-job button[type='submit'].btn-primary").each(function(t,o){var i=e(o);"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?i.on("click",function(){n(i)}):i.click(function(){n(i)})})}function l(t){e(".saved-jobs-icon").trigger("update",t),e(".jb-status").trigger("update")}var f=!1,b=o;return{bindEvents:v,triggerEvents:l}},function(e){e(document).ready(function(){var t=!1;TotalJobsGroup&&(t=TotalJobsGroup.IsJobsiteBrand),window.SavedJobsManager=SavedJobs.Manager(e,t);var o=SavedJobs.Events(e,window.SavedJobsManager,t);o.bindEvents(),window.SavedJobsManager.refreshSavedJobsFromServer(function(e){e&&o.triggerEvents({isInitialUpdate:!0})})})}(jQuery),"undefined"==typeof jQuery.cookie&&(jQuery.cookie=function(e,t,o){if(arguments.length>1&&(null===t||"object"!=typeof t)){if(o=jQuery.extend({},o),null===t&&(o.expires=-1),"number"==typeof o.expires){var n=o.expires,i=o.expires=new Date;i.setDate(i.getDate()+n)}return document.cookie=[encodeURIComponent(e),"=",o.raw?String(t):encodeURIComponent(String(t)),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}o=t||{};var a,r=o.raw?function(e){return e}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?r(a[1]):null}),function(e){function t(t,o){var n=null,i="JBM_COOKIE",a=null,r=0,s=768,u=function(){b(function(e){a=e,"undefined"==typeof o?d():o()}),r=E()},d=function(){a.toast.mouseenter(O),a.toast.mouseleave(l),a.toast.click(f),"undefined"!=typeof e.fn.on&&e.isFunction(e.fn.on)?e(".saved-jobs-icon").on("update",c):e(".saved-jobs-icon").bind("update",c),e(window).scroll(v)},c=function(t,o){var n=E();if(r!==n){p(n),m(e(this),a.title,n);var i=a.toast;!J(i)||"undefined"!=typeof o&&o.isInitialUpdate||k(i),r=n}},v=function(){var e=a.toast;T(e)&&J(e)},l=function(){M(t.mouseOutTimeout)},f=function(){a.toast.hide()},b=function(o){window.SavedJobsManager.getLoggedInState(function(n){var i="";i+='<div id="saved-job-toast" style="display:none">',i+='  <div id="saved-job-toast-title">'+t.savedJobText+"</div>",i+='  <div id="saved-job-toast-link">',i+='      <a href="/savedjobs/">View saved jobs</a>',i+="  </div>",i+=n>0?'  <div id="saved-job-toast-text">'+t.loggedInText+"</div>":'  <div id="saved-job-toast-text">'+t.notLoggedInText+"</div>",i+="</div>",e("body").append(i),o({toast:e("#saved-job-toast"),jobCount:e("#saved-job-toast-jobcount"),title:e("#saved-job-toast-title"),link:e("#saved-job-toast-link")})})},p=function(e){e>-1?a.jobCount.html(e+"&nbsp;"):a.jobCount.html("")},m=function(e,o,n){e.hasClass("saved")===!0?o.text(n+" "+t.savedJobText):o.text(t.removedJobText)},g=function(e,t){var o=e.outerWidth(),n=0,i=y();return n=i<s?h(o,i):j(o,t)},h=function(e,t){var o=0,n=t-e;return n>0&&(o=n/2),o},j=function(e,t){var o=0,n=t.offset();return n.left>0&&(o=n.left-e+t.width()),o},S=function(e){var t=0,o=x(e);return o&&(t=C(e)+10),t},J=function(e){var t=w();if(null==t)return!1;var o=g(e,t),n=S(t);return e.css("top",n),e.css("left",o),!0},k=function(e){O(),T(e)?e.show():e.slideDown(),M(t.visibleForTimeout)},C=function(t){var o=e(window).scrollTop(),n=t.offset();return n.top+t.outerHeight()-o},x=function(t){var o=e(window).scrollTop(),n=e(t).offset().top+e(t).outerHeight();return n>=o},y=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},w=function(){var t=e("#navbar-savedjobs");return 0===t.length&&(t=e(".jb-status")),t.length>0?t:null},T=function(e){return e.is(":visible")===!0},I=function(){a.toast.slideUp()},O=function(){null!=n&&clearTimeout(n)},M=function(e){var t=a.toast;1===t.length&&(n=setTimeout(I,e))},E=function(){var t=e.cookie(i);return null!==t?N(t):-1},N=function(e){if(e){var t=e.split("|");if(t.length>0&&null!==t[0]){var o=t[0].split(",");return o.length}}return-1};return u(),{bindEvents:d}}e(document).ready(function(){var e={visibleForTimeout:3e3,mouseOutTimeout:1e3,savedJobText:"Saved job(s)",removedJobText:"Removed job",notLoggedInText:'To view your saved jobs on any device, <a href="/Authenticated/Login.aspx">log&nbsp;in</a> or <a href="/Authenticated/UnAuth/NewUser.aspx">register</a>.',loggedInText:"Log in on any device to view your saved jobs."},o=new t(e);window.Toast=o})}(jQuery);
//# sourceMappingURL=savedjobs.min.js.map
